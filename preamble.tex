% # HFU LaTeX Vorlage
%
% Autor: Dominik Meurer
% Lizenz: "THE BEER-WARE LICENSE" (Revision 42):
% Dominik Meurer schrieb diese Datei. Solange Sie diesen Vermerk nicht entfernen, können
% Sie mit dem Material machen, was Sie möchten. Wenn wir uns eines Tages treffen und Sie
% denken, das Material ist es wert, können Sie mir dafür ein Bier ausgeben.
% Dominik Meurer



% ##################################################
% ENCODING
% ##################################################
\usepackage{cmap}               % PDF character encoding
\usepackage[T1]{fontenc}        % 8-bit font encoding
\usepackage[utf8]{inputenc}     % UTF-8 input encoding
\usepackage[german]{babel} %%%%% Sprache festlegen



% ##################################################
% DOCUMENT VARIABLES
% ##################################################
% Personal data
\newcommand{\docAuthor}{NAME}
\newcommand{\docMatriculationNumber}{MATRIKELNUMMER}
\newcommand{\docStudyProgram}{Informatik S+I}
\newcommand{\docStreetName}{STRASSE, HAUSNUMMER}
\newcommand{\docPostalCode}{PLZ}
\newcommand{\docCity}{ORT}
\newcommand{\docEmail}{EMAIL} % TOCHANGE email address

% Document data
\newcommand{\docTitle}{NAME}
\newcommand{\docSubTitle}{UNTERTITEL} % Leer lassen, wenn kein Untertitel
\newcommand{\docType}{Projektarbeit}
\newcommand{\docModule}{Plattform für Autonome Systeme}  % TOCHANGE muss man das hinschreiben?
\newcommand{\docSupervisor}{BETREUER}
\newcommand{\docCosupervisor}{KOBETREUER} % TOCHANGE supervisor or co-supervisor
\newcommand{\docDeadline}{ABGABEDATUM} % TOCHANGE submission date



% ##################################################
% GENERAL
% ##################################################
\usepackage{scrhack}            % better KOMA adaptions
\usepackage[table]{xcolor}      % color support
\usepackage{chngcntr}           % for renumbering stuff


\usepackage{amsthm}


\usepackage{lipsum}             % lorem ipsum generator (used for example content)


% ##################################################
% PDF SETTINGS
% ##################################################
\usepackage[
    colorlinks=false,
   	linkcolor=black,
   	citecolor=black,
  	filecolor=black,
	urlcolor=black,
    bookmarks=true,
    bookmarksopen=true,
    bookmarksopenlevel=3,
    bookmarksnumbered,
    plainpages=false,
    pdfpagelabels=true,
    hyperfootnotes,
    pdftitle ={\docTitle},
    pdfauthor={\docAuthor},
    pdfcreator={\docAuthor}
]{hyperref}



% ##################################################
% FONTS AND SPACING
% ##################################################
\renewcommand{\familydefault}{\sfdefault}   % default font
\usepackage[onehalfspacing]{setspace}       % default 1.5 line spacing
\raggedbottom   % don't stretch spacing to fit page length

\usepackage{anyfontsize} % use any font size

% font sizes and styles
\addtokomafont{chapter}{\sffamily\large\bfseries}  % chapter heading 
\addtokomafont{section}{\sffamily\normalsize\bfseries} 
\addtokomafont{subsection}{\sffamily\normalsize\mdseries}
\addtokomafont{caption}{\sffamily\normalsize\mdseries}

% url font style
\usepackage{relsize}
\renewcommand*{\UrlFont}{\ttfamily\smaller\relax}



% ##################################################
% PAGE FORMATTING
% ##################################################
% Page layout / Seitenränder
\usepackage[
	bindingoffset=1.5cm,
	inner=2.5cm,
	outer=2.5cm,
	top=3cm,
	bottom=2cm
]{geometry}

% Page header
\usepackage[
    headsepline,        % seperator line beneath page header on normal pages
    plainheadsepline    % seperator line beneath page header on pages like ToC
]{scrlayer-scrpage}
\clearpairofpagestyles                  % clear default settings
\addtokomafont{pagehead}{\normalfont}   % use normal font for page header
\ohead*{\thepage}                       % page number
\ihead*{\leftmark}                      % chapter name



% ##################################################
% IMAGES AND FIGURES
% ##################################################
\usepackage{graphicx}       % support for including images
\graphicspath{{pictures/}}  % default path

% simple numbering without chapter
\renewcommand{\thefigure}{\arabic{figure}}
\counterwithout{figure}{chapter}


\usepackage{wrapfig}       % wrap text around figures



% ##################################################
% TABLES
% ##################################################
\usepackage{booktabs}   % beautiful table style
\usepackage{multirow}   % multi row and multi column table functionality

% simple numbering without chapter
\renewcommand{\thetable}{\arabic{table}}
\counterwithout{table}{chapter}



% ##################################################
% SOURCE CODE LISTINGS
% ##################################################
\usepackage{listings}
\usepackage{beramono}   % use a typewriter font which supports bold characters

\renewcommand{\lstlistlistingname}{List of Code Listings}   % 
\renewcommand{\lstlistingname}{Code Listing}
\newcommand{\listoflolentryname}{\lstlistingname}   % prefix for List of Code Listings

% define colors for source code highlighting
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.5,0,0.33}
\definecolor{codepurblue}{rgb}{0.16,0.0,1.0}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

% set source code style
\lstdefinestyle{codestyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\bfseries\color{codepurple},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurblue},
    basicstyle=\scriptsize\ttfamily,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    escapeinside={(*@}{@*)}
}
\lstset{style=codestyle, numberbychapter=false}



% ##################################################
% TABLE OF CONTENTS
% ##################################################
\KOMAoptions{toc=chapterentrydotfill}       % dotted lines for chapters
\addtokomafont{chapterentry}{\normalfont}   % use normal font for chapter entries
\setuptoc{toc}{totoc}                       % add ToC to ToC

% spacing
\DeclareTOCStyleEntry[beforeskip=0cm]{chapter}{chapter}
\DeclareTOCStyleEntry[beforeskip=0cm]{section}{section}
\DeclareTOCStyleEntry[beforeskip=0cm]{default}{subsection}

% colons after entry names
\BeforeStartingTOC[lof]{\def\autodot{:}}
\BeforeStartingTOC[lot]{\def\autodot{:}}
\BeforeStartingTOC[lol]{\def\autodot{:}}



% ##################################################
% BIBLIOGRAPHY
% ##################################################
\usepackage{csquotes} % context sensitive quotation
\usepackage[backend=biber,citestyle=ieee]{biblatex} % bibliography support
\addbibresource{bibtex.bib} % bibliography file
\setlength\bibitemsep{.5\baselineskip} % increase spacing between entries
\setcounter{biburlnumpenalty}{9000} % break URLs on numbers
\setcounter{biburllcpenalty}{9000}  % break URLs on lower case letters
\setcounter{biburlucpenalty}{9000}  % break URLs on upper case letters



% ##################################################
% ABBREVIATIONS
% ##################################################
\usepackage[printonlyused]{acronym}



% ##################################################
% APPENDIX
% ##################################################
\usepackage[title,titletoc]{appendix}

% appendix chapter
\newcommand{\appendixchapter}[1]{
    \cleardoublepage
    \pagenumbering{arabic}
    \renewcommand{\thepage}{\thechapter-\arabic{page}}
    \chapter{#1}
}

% insert monthly report pdf as picture in order to keep page header
\newcommand{\monthlyreport}[2]{
    \section{#1}
    \centering
    \includegraphics[trim=55 35 55 35,clip,width=1\textwidth]{#2}
    \clearpage
}



% ##################################################
% Theoreme
% ##################################################
  	
% Umgebung fuer Beispiele
\newtheorem{beispiel}{Beispiel}

% Umgebung fuer These
\newtheorem{these}{These}

% Umgebung fuer Definitionen
\newtheorem{definition}{Definition}



% ##################################################
% MISC
% ##################################################
% better referencing of images, tables, etc.
\usepackage[nameinlink, noabbrev]{cleveref} 

% ##################################################
% CUSTOM LISTINGS LANGUAGE
% ##################################################

\lstdefinelanguage{json}{
    basicstyle=\normalfont\ttfamily,
    numbers=left,
    numberstyle=\scriptsize,
    stepnumber=1,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    backgroundcolor=\color{backcolour},
    literate=
     *{0}{{{\color{codepurblue}0}}}{1}
      {1}{{{\color{codepurblue}1}}}{1}
      {2}{{{\color{codepurblue}2}}}{1}
      {3}{{{\color{codepurblue}3}}}{1}
      {4}{{{\color{codepurblue}4}}}{1}
      {5}{{{\color{codepurblue}5}}}{1}
      {6}{{{\color{codepurblue}6}}}{1}
      {7}{{{\color{codepurblue}7}}}{1}
      {8}{{{\color{codepurblue}8}}}{1}
      {9}{{{\color{codepurblue}9}}}{1}
      {:}{{{\color{codegray}{:}}}}{1}
      {,}{{{\color{codegray}{,}}}}{1}
      {\{}{{{\color{codegreen}{\{}}}}{1}
      {\}}{{{\color{codegreen}{\}}}}}{1}
      {[}{{{\color{codegreen}{[}}}}{1}
      {]}{{{\color{codegreen}{]}}}}{1},
}

% ##################################################
% PowerApps Language Listing
% ##################################################
\definecolor{powerFxBlue}{RGB}{0,0,255} % could be used for functions
\definecolor{powerFxLightBlue}{RGB}{0, 124, 133} % could be used for collections
\definecolor{powerFxMediumBlue}{RGB}{0,0,200} % could be used for variables
\definecolor{powerFxRed}{RGB}{255,0,0} 
\definecolor{powerFxGreen}{RGB}{0,255,0} % could be used for comments
\definecolor{powerFxYellow}{RGB}{255,255,0}
\definecolor{powerFxPurple}{RGB}{128,0,128}
\definecolor{powerFxOrange}{RGB}{255,165,0} % could be used for strings
\definecolor{powerFxPink}{RGB}{255,192,203}
\definecolor{powerFxBlack}{RGB}{0,0,0}
\definecolor{powerFxLightGrey}{RGB}{232,232,232} % could be used for variable initialization
\definecolor{powerFxDarkGrey}{RGB}{110,110,110}

\lstdefinelanguage{PowerApps}{
    % &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    % Standard PA Functions in blue (rgb0,0,255)
    % add variables / collections / your own 'words' that you want to have colored in the specific premade keywordlist ( morekeywords )
    % add a new keywordslist with another color this way:
    % morekeywords=[6]{your,words,here}, keywordstyle=[6]\color{yourColor}, // 6 is an example, use any number that is not used yet
    % &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    keywords={ 
        % Variables & Collections --> add appropriatly if you miss anything
        UpdateContext, Set, Clear, Collect, ClearCollect, Remove, RemoveIf, 
        LookUp, First, Last, FirstN, LastN, Filter, Sort, SortByColumns, 
        Search, AddColumns, DropColumns, RenameColumns, ShowColumns, 
        SelectColumns, GroupBy, Ungroup, AddColumns, Select, CountRows, ForAll,
        IsEmpty, IsBlank, 
        % Logical Operations
        And, Or, Not, If, Switch, IsBlank, IsEmpty, IsError, IsMatch, MatchAll, Match, ForAll, IfError,
        % Math Operations
        Abs, Add, Average, Acos, Asin, Atan, Atan2, Sin, Cos, Tan, Sqrt, Mod, 
        Round, Sum, Subtract, Multiply, Divide, Power, Min, Max, RoundUp, RoundDown, Rand, Long,
        Log, Pi, Exp, Degrees, Radians, Degrees
        % String Operations
        Concat, Left, Right, Mid, Len, Lower, Upper, Proper, Trim, TrimEnds, Replace, Substitute,
        Concatenate, StartsWith, EndsWith, Find, Search, Split, Text, Value,
        Navigate, Back, Refresh, 
        Patch, 
        Text(, Value, 
        Concatenate, Mid, Len, Trim, Lower, Upper, Proper, Replace, Substitute, Round, TrimEnds,
        RoundUp, RoundDown, Truncate,  
        Split, Trim, Left, Right, Concatenate,
        Notify, Reset, With, ForEach, AddColumns, Select, RGBA,
        % Office365Users
        DirectReports, DirectReportsV2, HttpRequest, Manager, ManagerV2, MyProfile, MyProfileV2, MyTrendingDocuments, RelevantPeople, SearchUser, SearchUserV2, TrendingDocuments, UpdateMyPhoto, UpdateMyProfile, UserPhoto, UserPhotoMetadata, UserPhotoV2, UserProfile, UserProfileV2 },
    keywordstyle=\color{powerFxBlue}\bfseries,
    comment=[l]{//},
    commentstyle=\color{powerFxGreen}\ttfamily,
    stringstyle=\color{powerFxOrange}\ttfamily,
    morestring=[b]",
    morestring=[b]',
    % -----------------------------------------
    % variables on right side or highlightcolor: blue (rgb0,0,200)
    % -----------------------------------------
    morekeywords=[2]{
        const
    }, keywordstyle=[2]\color{powerFxMediumBlue},
    % -----------------------------------------
    % collections or highlightcolor: light blue
    % -----------------------------------------
    morekeywords=[3]{
        col_Feedback
    }, keywordstyle=[3]\color{powerFxLightBlue},
    % -----------------------------------------
    % functions or highlightcolor: red
    % -----------------------------------------
    morekeywords=[4]{
        Mail,
        Email,
        Text,
        EntraObjectId,
        FullName,
        Image,
    }, keywordstyle=[4]\color{powerFxPurple},
    % -----------------------------------------
    % new variables or highlightcolor: dark grey
    % -----------------------------------------
    morekeywords=[5]{
        rating, 
        comment
    }, keywordstyle=[5]\color{powerFxDarkGrey},
    literate={*}{{\textcolor{powerFxPink}{*}}}{1}
        {=}{{\textcolor{black}{=}}}{1}
        {,}{{\textcolor{black}{,}}}{1}
        {;}{{\textcolor{black}{;}}}{1}
        {:}{{\textcolor{black}{:}}}{1}
        {.}{{\textcolor{black}{.}}}{1}
        {(}{{\textcolor{black}{(}}}{1}
        {)}{{\textcolor{black}{)}}}{1}
        {[}{{\textcolor{black}{[}}}{1}
        {]}{{\textcolor{black}{]}}}{1}
        {\{}{{\textcolor{black}{\{}}}{1}
        {\}}{{\textcolor{black}{\}}}}{1}
}